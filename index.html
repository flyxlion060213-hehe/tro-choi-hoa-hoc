<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>üß™ ƒê·∫§U TR∆Ø·ªúNG H√ìA H·ªåC 140 - 30 PH√öT</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2563eb; --success: #10b981; --danger: #ef4444; --bg: #f0f7ff; }
        body {
            font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg);
            margin: 0; display: flex; justify-content: center; align-items: center;
            min-height: 100vh; overflow: hidden; color: #1e293b;
        }
        .bubble {
            position: absolute; bottom: -100px; background: rgba(37, 99, 235, 0.15);
            border-radius: 50%; animation: rise 12s infinite linear; z-index: 0;
        }
        @keyframes rise {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            50% { opacity: 0.7; }
            100% { transform: translateY(-120vh) scale(1.6); opacity: 0; }
        }
        .container {
            background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px);
            width: 95%; max-width: 750px; padding: 35px; border-radius: 35px;
            box-shadow: 0 30px 60px -15px rgba(0,0,0,0.2); text-align: center;
            z-index: 10; border: 1px solid #fff;
        }
        .header-info { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .info-card { background: #f8fafc; padding: 15px; border-radius: 18px; border: 1px solid #e2e8f0; font-weight: 800; }
        .info-card span { display: block; font-size: 20px; color: var(--primary); margin-top: 5px; }
        .timer-container { width: 100%; height: 12px; background: #e2e8f0; border-radius: 10px; margin: 20px 0; overflow: hidden; }
        #progress { width: 100%; height: 100%; background: linear-gradient(90deg, #3b82f6, #06b6d4); transition: width 1s linear; }
        .equation-area {
            background: #ffffff; padding: 30px; border-radius: 25px; margin-bottom: 25px;
            font-size: 24px; font-weight: 700; display: flex; flex-wrap: wrap;
            justify-content: center; align-items: center; gap: 10px; border: 2px solid #f1f5f9;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        input.coeff {
            width: 50px; height: 50px; text-align: center; font-size: 22px;
            font-weight: 800; border: 2.5px solid #cbd5e1; border-radius: 12px; color: var(--primary);
            transition: all 0.2s;
        }
        input.coeff:focus { outline: none; border-color: var(--primary); background: #eff6ff; }
        button {
            width: 100%; padding: 20px; font-size: 20px; font-weight: 800; border: none;
            border-radius: 20px; cursor: pointer; transition: all 0.2s; text-transform: uppercase;
        }
        .btn-check { background: var(--primary); color: white; box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.4); }
        .btn-next { background: var(--success); color: white; display: none; box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.4); }
        #msg { height: 30px; margin-bottom: 15px; font-weight: 700; font-size: 18px; }
        .shake { animation: shake 0.4s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 20% { transform: translateX(-10px); } 60% { transform: translateX(10px); } }
    </style>
</head>
<body>

<div class="container" id="main-card">
    <div class="header-info">
        <div class="info-card">üèÜ ƒêI·ªÇM <span id="score">0</span></div>
        <div class="info-card">‚≠ê C·∫§P <span id="rank">T·∫≠p s·ª±</span></div>
        <div class="info-card">‚è≥ C√íN <span id="time-text">30:00</span></div>
    </div>
    <div class="timer-container"><div id="progress"></div></div>
    <div id="equation-area" class="equation-area">üß™ ƒêang pha ch·∫ø h√≥a ch·∫•t...</div>
    <div id="msg"></div>
    <button id="btn-check" class="btn-check" onclick="checkAnswer()">Ki·ªÉm tra k·∫øt qu·∫£</button>
    <button id="btn-next" class="btn-next" onclick="nextQuestion()">Ph·∫£n ·ª©ng ti·∫øp theo ‚ûî</button>
</div>

<script>
    // FULL 140 PH·∫¢N ·ª®NG THCS
    const db = [
/* ===== KIM LO·∫†I + PHI KIM ===== */
{r:['H2','O2'],p:['H2O'],c:[2,1,2]},
{r:['C','O2'],p:['CO2'],c:[1,1,1]},
{r:['S','O2'],p:['SO2'],c:[1,1,1]},
{r:['P','O2'],p:['P2O5'],c:[4,5,2]},
{r:['Fe','O2'],p:['Fe3O4'],c:[3,2,1]},
{r:['Al','O2'],p:['Al2O3'],c:[4,3,2]},
{r:['Mg','O2'],p:['MgO'],c:[2,1,2]},
{r:['Na','O2'],p:['Na2O'],c:[4,1,2]},
{r:['Fe','Cl2'],p:['FeCl3'],c:[2,3,2]},
{r:['Al','Cl2'],p:['AlCl3'],c:[2,3,2]},
{r:['Cu','Cl2'],p:['CuCl2'],c:[1,1,1]},
{r:['Mg','S'],p:['MgS'],c:[1,1,1]},
{r:['Fe','S'],p:['FeS'],c:[1,1,1]},
{r:['Na','Cl2'],p:['NaCl'],c:[2,1,2]},
{r:['H2','Cl2'],p:['HCl'],c:[1,1,2]},
{r:['H2','S'],p:['H2S'],c:[1,1,1]},

/* ===== OXIT + N∆Ø·ªöC / AXIT ===== */
{r:['CaO','H2O'],p:['Ca(OH)2'],c:[1,1,1]},
{r:['Na2O','H2O'],p:['NaOH'],c:[1,1,2]},
{r:['BaO','H2O'],p:['Ba(OH)2'],c:[1,1,1]},
{r:['K2O','H2O'],p:['KOH'],c:[1,1,2]},
{r:['SO2','H2O'],p:['H2SO3'],c:[1,1,1]},
{r:['SO3','H2O'],p:['H2SO4'],c:[1,1,1]},
{r:['P2O5','H2O'],p:['H3PO4'],c:[1,3,2]},
{r:['N2O5','H2O'],p:['HNO3'],c:[1,1,2]},
{r:['CuO','HCl'],p:['CuCl2','H2O'],c:[1,2,1,1]},
{r:['Fe2O3','HCl'],p:['FeCl3','H2O'],c:[1,6,2,3]},
{r:['Al2O3','H2SO4'],p:['Al2(SO4)3','H2O'],c:[1,3,1,3]},
{r:['ZnO','HNO3'],p:['Zn(NO3)2','H2O'],c:[1,2,1,1]},
{r:['MgO','HCl'],p:['MgCl2','H2O'],c:[1,2,1,1]},
{r:['CaO','HCl'],p:['CaCl2','H2O'],c:[1,2,1,1]},
{r:['ZnO','H2SO4'],p:['ZnSO4','H2O'],c:[1,1,1,1]},

/* ===== KIM LO·∫†I + AXIT / N∆Ø·ªöC ===== */
{r:['Zn','HCl'],p:['ZnCl2','H2'],c:[1,2,1,1]},
{r:['Fe','HCl'],p:['FeCl2','H2'],c:[1,2,1,1]},
{r:['Al','HCl'],p:['AlCl3','H2'],c:[2,6,2,3]},
{r:['Mg','H2SO4'],p:['MgSO4','H2'],c:[1,1,1,1]},
{r:['Fe','H2SO4'],p:['FeSO4','H2'],c:[1,1,1,1]},
{r:['Al','H2SO4'],p:['Al2(SO4)3','H2'],c:[2,3,1,3]},
{r:['Na','H2O'],p:['NaOH','H2'],c:[2,2,2,1]},
{r:['Ca','H2O'],p:['Ca(OH)2','H2'],c:[1,2,1,1]},
{r:['K','H2O'],p:['KOH','H2'],c:[2,2,2,1]},

/* ===== AXIT + BAZ∆† ===== */
{r:['NaOH','HCl'],p:['NaCl','H2O'],c:[1,1,1,1]},
{r:['KOH','HNO3'],p:['KNO3','H2O'],c:[1,1,1,1]},
{r:['Ba(OH)2','HCl'],p:['BaCl2','H2O'],c:[1,2,1,2]},
{r:['Ca(OH)2','H2SO4'],p:['CaSO4','H2O'],c:[1,1,1,2]},
{r:['Fe(OH)3','HCl'],p:['FeCl3','H2O'],c:[1,3,1,3]},
{r:['Cu(OH)2','H2SO4'],p:['CuSO4','H2O'],c:[1,1,1,2]},

/* ===== TRAO ƒê·ªîI ‚Äì K·∫æT T·ª¶A ===== */
{r:['AgNO3','NaCl'],p:['AgCl','NaNO3'],c:[1,1,1,1]},
{r:['BaCl2','Na2SO4'],p:['BaSO4','NaCl'],c:[1,1,1,2]},
{r:['Ba(NO3)2','K2SO4'],p:['BaSO4','KNO3'],c:[1,1,1,2]},
{r:['CaCl2','Na2CO3'],p:['CaCO3','NaCl'],c:[1,1,1,2]},
{r:['FeCl3','NaOH'],p:['Fe(OH)3','NaCl'],c:[1,3,1,3]},
{r:['CuSO4','KOH'],p:['Cu(OH)2','K2SO4'],c:[1,2,1,1]},
{r:['Na2SO4','BaCl2'],p:['BaSO4','NaCl'],c:[1,1,1,2]},
{r:['Na2CO3','CaCl2'],p:['CaCO3','NaCl'],c:[1,1,1,2]},

/* ===== MU·ªêI + AXIT ===== */
{r:['Na2CO3','HCl'],p:['NaCl','CO2','H2O'],c:[1,2,2,1,1]},
{r:['CaCO3','HCl'],p:['CaCl2','CO2','H2O'],c:[1,2,1,1,1]},
{r:['NaHCO3','HCl'],p:['NaCl','CO2','H2O'],c:[1,1,1,1,1]},
{r:['NaHCO3','H2SO4'],p:['Na2SO4','CO2','H2O'],c:[2,1,1,2,2]},

/* ===== NHI·ªÜT PH√ÇN ===== */
{r:['CaCO3'],p:['CaO','CO2'],c:[1,1,1]},
{r:['KClO3'],p:['KCl','O2'],c:[2,2,3]},
{r:['KMnO4'],p:['K2MnO4','MnO2','O2'],c:[2,1,1,1]},
{r:['Cu(OH)2'],p:['CuO','H2O'],c:[1,1,1]},
{r:['Fe(OH)3'],p:['Fe2O3','H2O'],c:[2,1,3]},
{r:['Al(OH)3'],p:['Al2O3','H2O'],c:[2,1,3]},
{r:['Mg(OH)2'],p:['MgO','H2O'],c:[1,1,1]},

/* ===== KH·ª¨ OXIT ===== */
{r:['CuO','H2'],p:['Cu','H2O'],c:[1,1,1,1]},
{r:['Fe2O3','H2'],p:['Fe','H2O'],c:[1,3,2,3]},
{r:['Fe3O4','CO'],p:['Fe','CO2'],c:[1,4,3,4]},
{r:['Fe2O3','CO'],p:['Fe','CO2'],c:[1,3,2,3]},

/* ===== H·ªÆU C∆† C∆† B·∫¢N ===== */
{r:['CH4','O2'],p:['CO2','H2O'],c:[1,2,1,2]},
{r:['C2H4','O2'],p:['CO2','H2O'],c:[1,3,2,2]},
{r:['C2H2','O2'],p:['CO2','H2O'],c:[2,5,4,2]},
{r:['C2H5OH','O2'],p:['CO2','H2O'],c:[1,3,2,3]},
{r:['CH3COOH','NaOH'],p:['CH3COONa','H2O'],c:[1,1,1,1]},

/* ===== KH√ç ƒêI·ªÄU CH·∫æ ===== */
{r:['NH4Cl','NaOH'],p:['NaCl','NH3','H2O'],c:[1,1,1,1,1]},
{r:['MnO2','HCl'],p:['MnCl2','Cl2','H2O'],c:[1,4,1,1,2]}
    ];

    let score = 0, timeLeft = 1800, currentQ, timer;

    function playSound(f) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const o = ctx.createOscillator(), g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination); o.frequency.value = f;
        o.start(); g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.1); o.stop(ctx.currentTime + 0.1);
    }

    function createBubbles() {
        for (let i = 0; i < 20; i++) {
            const b = document.createElement('div'); b.className = 'bubble';
            b.style.left = Math.random() * 100 + 'vw';
            const s = Math.random() * 60 + 20; b.style.width = b.style.height = s + 'px';
            b.style.animationDelay = Math.random() * 8 + 's'; document.body.appendChild(b);
        }
    }

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            const m = Math.floor(timeLeft / 60), s = timeLeft % 60;
            document.getElementById('time-text').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
            document.getElementById('progress').style.width = (timeLeft / 1800 * 100) + '%';
            if (timeLeft <= 0) { clearInterval(timer); alert("H·∫øt gi·ªù! ƒêi·ªÉm: " + score); location.reload(); }
        }, 1000);
    }

    function format(t) { return t.replace(/(\d+)/g, '<sub>$1</sub>'); }

    function loadQuestion() {
        document.getElementById('msg').innerText = "";
        document.getElementById('btn-check').style.display = "block";
        document.getElementById('btn-next').style.display = "none";
        currentQ = db[Math.floor(Math.random() * db.length)];
        const area = document.getElementById('equation-area'); area.innerHTML = '';

        currentQ.r.forEach((item, i) => {
            area.innerHTML += `<input type="number" class="coeff" id="r${i}" placeholder="1"> ${format(item)}`;
            if (i < currentQ.r.length - 1) area.innerHTML += ' + ';
        });
        area.innerHTML += ' ‚ûî ';
        currentQ.p.forEach((item, i) => {
            area.innerHTML += `<input type="number" class="coeff" id="p${i}" placeholder="1"> ${format(item)}`;
            if (i < currentQ.p.length - 1) area.innerHTML += ' + ';
        });
    }

    function checkAnswer() {
        let u = [];
        currentQ.r.forEach((_, i) => u.push(parseInt(document.getElementById(`r${i}`).value) || 1));
        currentQ.p.forEach((_, i) => u.push(parseInt(document.getElementById(`p${i}`).value) || 1));

        if (JSON.stringify(u) === JSON.stringify(currentQ.c)) {
            score += 10; playSound(800);
            document.getElementById('score').innerText = score;
            document.getElementById('msg').innerHTML = "‚úÖ CH√çNH X√ÅC! TUY·ªÜT V·ªúI";
            document.getElementById('msg').style.color = "var(--success)";
            document.getElementById('btn-check').style.display = "none";
            document.getElementById('btn-next').style.display = "block";
            const r = score < 100 ? "T·∫≠p s·ª±" : score < 300 ? "H·ªçc gi·∫£" : score < 600 ? "B√°c h·ªçc" : "Huy·ªÅn tho·∫°i";
            document.getElementById('rank').innerText = r;
        } else {
            playSound(200); document.getElementById('msg').innerHTML = "‚ùå SAI R·ªíI! TH·ª¨ L·∫†I XEM";
            document.getElementById('msg').style.color = "var(--danger)";
            const c = document.getElementById('main-card');
            c.classList.add('shake'); setTimeout(() => c.classList.remove('shake'), 400);
        }
    }

    function nextQuestion() { loadQuestion(); }

    window.onload = () => { createBubbles(); loadQuestion(); startTimer(); };
</script>
</body>
</html>
